## üíä README: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –°—Ö–µ–º –•–∏–º–∏–æ—Ç–µ—Ä–∞–ø–∏–∏ (–ü–ö/–ü–î –ú–æ–¥–µ–ª—å)

-----

### 1\. üìù –û–ø–∏—Å–∞–Ω–∏–µ –ü—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç Python-—Å–∫—Ä–∏–ø—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ú–æ–¥–µ–ª—å –§–∞—Ä–º–∞–∫–æ–∫–∏–Ω–µ—Ç–∏–∫–∏ –∏ –§–∞—Ä–º–∞–∫–æ–¥–∏–Ω–∞–º–∏–∫–∏ (–ü–ö/–ü–î)** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏—Å—Ç–µ–º—ã –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π (–û–î–£).

–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ–∑—ã –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –≤–≤–µ–¥–µ–Ω–∏—è —Ö–∏–º–∏–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞** –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å —Ä–∞–∫–æ–º –º–æ–ª–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã (–†–ú–ñ) –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫.

–°–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç:

1.  **–ü–ö/–ü–î –ú–æ–¥–µ–ª—å (–ö–ª–∞—Å—Å `PKPDModel`):** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ –æ–ø—É—Ö–æ–ª–∏ (–ì–æ–º–ø–µ—Ä—Ç—Ü), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ ($\text{V}_{\text{S}}$) –∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ ($\text{V}_{\text{R}}$) –∫–ª–µ—Ç–∫–∏, –¥–≤—É—Ö–∫–∞–º–µ—Ä–Ω—É—é —Ñ–∞—Ä–º–∞–∫–æ–∫–∏–Ω–µ—Ç–∏–∫—É (–ü–ö) –∏ —Ñ–∞—Ä–º–∞–∫–æ–¥–∏–Ω–∞–º–∏–∫—É (–ü–î).
2.  **–§—É–Ω–∫—Ü–∏—è –ü—Ä–æ–≥–Ω–æ–∑–∞:** –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞, —Å—Ç–∞–¥–∏–∏ –∏ —É—Ä–æ–≤–Ω—è Ki-67.
3.  **–§—É–Ω–∫—Ü–∏—è –ü–æ—Ç–µ—Ä—å (`loss_function`):** –û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ö–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º –æ–ø—É—Ö–æ–ª–∏ ($\text{V}_{\text{Total}}$) –∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—É—é –ø–æ–ø—É–ª—è—Ü–∏—é ($\text{V}_{\text{R}}$), –∞ —Ç–∞–∫–∂–µ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç **–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π —à—Ç—Ä–∞—Ñ –∑–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞ (ECOG).
4.  **API-–≠–Ω–¥–ø–æ–∏–Ω—Ç (`optimize_regimen_api`):** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–¥–µ–ª–∏, —Ä–∞—Å—á–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ö–µ–º—ã –∏ **—á–∏—Å–ª–µ–Ω–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ `L-BFGS-B` –∏–∑ `scipy.optimize`.

-----

### 2\. ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

  * **`numpy`:** –î–ª—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –º–∞—Å—Å–∏–≤–æ–≤.
  * **`scipy`:** –î–ª—è —Ä–µ—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –û–î–£ (`odeint`) –∏ —á–∏—Å–ª–µ–Ω–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (`minimize`).
  * **`math`:** –î–ª—è –±–∞–∑–æ–≤—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.
  * **`json`** (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–¥–µ, –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API).

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
pip install numpy scipy
```

-----

### 3\. üß™ –ú–æ–¥–µ–ª—å –∏ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –û—Å–Ω–æ–≤–∞

#### 3.1. PK/PD –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

–ú–æ–¥–µ–ª—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

  * **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ ($\lambda_{\text{S}}, \lambda_{\text{R}}$):** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ `_calculate_lambda_s` –Ω–∞ –æ—Å–Ω–æ–≤–µ **–º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞** (`TNBC`, `HR-HER2+`, `HR+HER2+`, `HR+HER2-`) –∏ —É—Ä–æ–≤–Ω—è **Ki-67**.
  * **–°–∫–æ—Ä–æ—Å—Ç—å —ç–ª–∏–º–∏–Ω–∞—Ü–∏–∏ ($\text{k}_{\text{e}}$):** –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç **–≤–æ–∑—Ä–∞—Å—Ç–∞** –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–≥–µ—Ä–∏–∞—Ç—Ä–∏—á–µ—Å–∫–∏–µ, –ø–µ–¥–∏–∞—Ç—Ä–∏—á–µ—Å–∫–∏–µ/–º–æ–ª–æ–¥—ã–µ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã).

#### 3.2. –°–∏—Å—Ç–µ–º–∞ –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –£—Ä–∞–≤–Ω–µ–Ω–∏–π (–û–î–£)

–í –æ—Å–Ω–æ–≤–µ –ª–µ–∂–∏—Ç —Å–∏—Å—Ç–µ–º–∞ –∏–∑ –ø—è—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–π, –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è –¥–∏–Ω–∞–º–∏–∫—É:

$$
\frac{d\mathbf{y}}{dt} = \text{f}(\mathbf{y}, t, \text{Dose}, \text{Interval})
$$–≥–¥–µ $\mathbf{y} = [\text{V}_{\text{S}}, \text{V}_{\text{R}}, \text{C}_1, \text{C}_2, \text{Tox}_{\text{Time}}]$.

* **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ ($\text{V}_{\text{S}}$):**
$$

```
$$\\frac{dV\_S}{dt} = V\_S \\cdot (G\_S - E\_C - \\mu)
$$
$$
```

  * **–†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ ($\text{V}_{\text{R}}$):**
    $$
    $$$$\\frac{dV\_R}{dt} = V\_R \\cdot G\_R + V\_S \\cdot \\mu - V\_R \\cdot E\_C \\cdot 0.1
    $$
    $$$$($G_S, G_R$ ‚Äî –ì–æ–º–ø–µ—Ä—Ç—Ü–æ–≤—Å–∫–∏–π —Ä–æ—Å—Ç; $E_C$ ‚Äî —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞; $\mu$ ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –º—É—Ç–∞—Ü–∏–∏; $\text{C}_1, \text{C}_2$ ‚Äî –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –≤ –∫–∞–º–µ—Ä–∞—Ö).

-----

### 4\. üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (API-–≠–Ω–¥–ø–æ–∏–Ω—Ç)

–û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `optimize_regimen_api(input_data)`.

#### 4.1. –í—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ (`input_data`)

–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å Python (–∏–º–∏—Ç–∞—Ü–∏—è JSON-–∑–∞–ø—Ä–æ—Å–∞) —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```python
input_data = {
    "patient_data": {
        "tumor_size_cm": float,   # –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–ø—É—Ö–æ–ª–∏ (—Å–º)
        "subtype": str,           # –ú–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã–π –ø–æ–¥—Ç–∏–ø ("TNBC", "HR+HER2-", –∏ —Ç.–¥.)
        "ki67_level": float,      # –£—Ä–æ–≤–µ–Ω—å Ki-67 (%)
        "age": int,               # –í–æ–∑—Ä–∞—Å—Ç (–¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ PK)
        "patient_stage": int,     # –°—Ç–∞–¥–∏—è (1-4, –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ Loss)
        "ecog_status": int        # –°—Ç–∞—Ç—É—Å ECOG (0-4, –¥–ª—è —à—Ç—Ä–∞—Ñ–∞ –∑–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å)
    },
    "initial_regimen": {
        "dose": float,            # –ò—Å—Ö–æ–¥–Ω–∞—è (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è) –¥–æ–∑–∞ (–º–≥)
        "interval": float         # –ò—Å—Ö–æ–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–Ω–∏)
    }
}
```

#### 4.2. –í—ã—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ (–ü—Ä–∏–º–µ—Ä)

–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```json
{
  "status": "success",
  "recommended_treatment_type": "–•–∏—Ä—É—Ä–≥–∏—è + –•–∏–º–∏–æ—Ç–µ—Ä–∞–ø–∏—è",
  "optimal_regimen": {
    "dose": "285.50",          // –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∞ (–º–≥)
    "interval": "12.00",       // –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–Ω–∏)
    "cycles": 6,
    "total_time_days": "72.00"
  },
  "metrics": {
    "initial": { /* ... –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ö–µ–º—ã ... */ },
    "optimal": {
      "V_end_cm3": "1.52",      // –ö–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º
      "VR_end_cm3": "0.0001",   // –†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –ø–æ–ø—É–ª—è—Ü–∏—è
      "Tox_time_days": "0.00"   // –í—Ä–µ–º—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏
    }
  },
  "plot_data": { /* ... –º–∞—Å—Å–∏–≤—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–≤—Ä–µ–º—è, –æ–±—ä–µ–º, –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è) ... */ }
}
```

-----
## üíä README: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –°—Ö–µ–º –•–∏–º–∏–æ—Ç–µ—Ä–∞–ø–∏–∏ (–ü–ö/–ü–î –ú–æ–¥–µ–ª—å)

-----

### 1\. üìù –û–ø–∏—Å–∞–Ω–∏–µ –ü—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç Python-—Å–∫—Ä–∏–ø—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ú–æ–¥–µ–ª—å –§–∞—Ä–º–∞–∫–æ–∫–∏–Ω–µ—Ç–∏–∫–∏ –∏ –§–∞—Ä–º–∞–∫–æ–¥–∏–Ω–∞–º–∏–∫–∏ (–ü–ö/–ü–î)** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏—Å—Ç–µ–º—ã –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π (–û–î–£).

–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ–∑—ã –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –≤–≤–µ–¥–µ–Ω–∏—è —Ö–∏–º–∏–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞** –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å —Ä–∞–∫–æ–º –º–æ–ª–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã (–†–ú–ñ) –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫.

–°–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç:

1.  **–ü–ö/–ü–î –ú–æ–¥–µ–ª—å (–ö–ª–∞—Å—Å `PKPDModel`):** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ –æ–ø—É—Ö–æ–ª–∏ (–ì–æ–º–ø–µ—Ä—Ç—Ü), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ ($\text{V}_{\text{S}}$) –∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ ($\text{V}_{\text{R}}$) –∫–ª–µ—Ç–∫–∏, –¥–≤—É—Ö–∫–∞–º–µ—Ä–Ω—É—é —Ñ–∞—Ä–º–∞–∫–æ–∫–∏–Ω–µ—Ç–∏–∫—É (–ü–ö) –∏ —Ñ–∞—Ä–º–∞–∫–æ–¥–∏–Ω–∞–º–∏–∫—É (–ü–î).
2.  **–§—É–Ω–∫—Ü–∏—è –ü—Ä–æ–≥–Ω–æ–∑–∞:** –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞, —Å—Ç–∞–¥–∏–∏ –∏ —É—Ä–æ–≤–Ω—è Ki-67.
3.  **–§—É–Ω–∫—Ü–∏—è –ü–æ—Ç–µ—Ä—å (`loss_function`):** –û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ö–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º –æ–ø—É—Ö–æ–ª–∏ ($\text{V}_{\text{Total}}$) –∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—É—é –ø–æ–ø—É–ª—è—Ü–∏—é ($\text{V}_{\text{R}}$), –∞ —Ç–∞–∫–∂–µ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç **–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π —à—Ç—Ä–∞—Ñ –∑–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞ (ECOG).
4.  **API-–≠–Ω–¥–ø–æ–∏–Ω—Ç (`optimize_regimen_api`):** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–¥–µ–ª–∏, —Ä–∞—Å—á–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ö–µ–º—ã –∏ **—á–∏—Å–ª–µ–Ω–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ `L-BFGS-B` –∏–∑ `scipy.optimize`.

-----## üíä README: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –°—Ö–µ–º –•–∏–º–∏–æ—Ç–µ—Ä–∞–ø–∏–∏ (–ü–ö/–ü–î –ú–æ–¥–µ–ª—å)

-----

### 1\. üìù –û–ø–∏—Å–∞–Ω–∏–µ –ü—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç Python-—Å–∫—Ä–∏–ø—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ú–æ–¥–µ–ª—å –§–∞—Ä–º–∞–∫–æ–∫–∏–Ω–µ—Ç–∏–∫–∏ –∏ –§–∞—Ä–º–∞–∫–æ–¥–∏–Ω–∞–º–∏–∫–∏ (–ü–ö/–ü–î)** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏—Å—Ç–µ–º—ã –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π (–û–î–£).

–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ–∑—ã –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –≤–≤–µ–¥–µ–Ω–∏—è —Ö–∏–º–∏–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞** –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å —Ä–∞–∫–æ–º –º–æ–ª–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã (–†–ú–ñ) –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫.

–°–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç:

1.  **–ü–ö/–ü–î –ú–æ–¥–µ–ª—å (–ö–ª–∞—Å—Å `PKPDModel`):** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ –æ–ø—É—Ö–æ–ª–∏ (–ì–æ–º–ø–µ—Ä—Ç—Ü), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ ($\text{V}_{\text{S}}$) –∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ ($\text{V}_{\text{R}}$) –∫–ª–µ—Ç–∫–∏, –¥–≤—É—Ö–∫–∞–º–µ—Ä–Ω—É—é —Ñ–∞—Ä–º–∞–∫–æ–∫–∏–Ω–µ—Ç–∏–∫—É (–ü–ö) –∏ —Ñ–∞—Ä–º–∞–∫–æ–¥–∏–Ω–∞–º–∏–∫—É (–ü–î).
2.  **–§—É–Ω–∫—Ü–∏—è –ü—Ä–æ–≥–Ω–æ–∑–∞:** –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞, —Å—Ç–∞–¥–∏–∏ –∏ —É—Ä–æ–≤–Ω—è Ki-67.
3.  **–§—É–Ω–∫—Ü–∏—è –ü–æ—Ç–µ—Ä—å (`loss_function`):** –û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ö–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º –æ–ø—É—Ö–æ–ª–∏ ($\text{V}_{\text{Total}}$) –∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—É—é –ø–æ–ø—É–ª—è—Ü–∏—é ($\text{V}_{\text{R}}$), –∞ —Ç–∞–∫–∂–µ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç **–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π —à—Ç—Ä–∞—Ñ –∑–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞ (ECOG).
4.  **API-–≠–Ω–¥–ø–æ–∏–Ω—Ç (`optimize_regimen_api`):** –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–¥–µ–ª–∏, —Ä–∞—Å—á–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ö–µ–º—ã –∏ **—á–∏—Å–ª–µ–Ω–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ `L-BFGS-B` –∏–∑ `scipy.optimize`.

-----

### 2\. ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

  * **`numpy`:** –î–ª—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –º–∞—Å—Å–∏–≤–æ–≤.
  * **`scipy`:** –î–ª—è —Ä–µ—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –û–î–£ (`odeint`) –∏ —á–∏—Å–ª–µ–Ω–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (`minimize`).
  * **`math`:** –î–ª—è –±–∞–∑–æ–≤—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.
  * **`json`** (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–¥–µ, –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API).

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
pip install numpy scipy
```

-----

### 3\. üß™ –ú–æ–¥–µ–ª—å –∏ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –û—Å–Ω–æ–≤–∞

#### 3.1. PK/PD –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

–ú–æ–¥–µ–ª—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

  * **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ ($\lambda_{\text{S}}, \lambda_{\text{R}}$):** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ `_calculate_lambda_s` –Ω–∞ –æ—Å–Ω–æ–≤–µ **–º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞** (`TNBC`, `HR-HER2+`, `HR+HER2+`, `HR+HER2-`) –∏ —É—Ä–æ–≤–Ω—è **Ki-67**.
  * **–°–∫–æ—Ä–æ—Å—Ç—å —ç–ª–∏–º–∏–Ω–∞—Ü–∏–∏ ($\text{k}_{\text{e}}$):** –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç **–≤–æ–∑—Ä–∞—Å—Ç–∞** –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–≥–µ—Ä–∏–∞—Ç—Ä–∏—á–µ—Å–∫–∏–µ, –ø–µ–¥–∏–∞—Ç—Ä–∏—á–µ—Å–∫–∏–µ/–º–æ–ª–æ–¥—ã–µ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã).

#### 3.2. –°–∏—Å—Ç–µ–º–∞ –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –£—Ä–∞–≤–Ω–µ–Ω–∏–π (–û–î–£)

–í –æ—Å–Ω–æ–≤–µ –ª–µ–∂–∏—Ç —Å–∏—Å—Ç–µ–º–∞ –∏–∑ –ø—è—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–π, –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è –¥–∏–Ω–∞–º–∏–∫—É:

$$
\frac{d\mathbf{y}}{dt} = \text{f}(\mathbf{y}, t, \text{Dose}, \text{Interval})
$$–≥–¥–µ $\mathbf{y} = [\text{V}_{\text{S}}, \text{V}_{\text{R}}, \text{C}_1, \text{C}_2, \text{Tox}_{\text{Time}}]$.

* **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ ($\text{V}_{\text{S}}$):**
$$

```
$$\\frac{dV\_S}{dt} = V\_S \\cdot (G\_S - E\_C - \\mu)
$$
$$
```

  * **–†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ ($\text{V}_{\text{R}}$):**
    $$
    $$$$\\frac{dV\_R}{dt} = V\_R \\cdot G\_R + V\_S \\cdot \\mu - V\_R \\cdot E\_C \\cdot 0.1
    $$
    $$$$($G_S, G_R$ ‚Äî –ì–æ–º–ø–µ—Ä—Ç—Ü–æ–≤—Å–∫–∏–π —Ä–æ—Å—Ç; $E_C$ ‚Äî —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞; $\mu$ ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –º—É—Ç–∞—Ü–∏–∏; $\text{C}_1, \text{C}_2$ ‚Äî –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –≤ –∫–∞–º–µ—Ä–∞—Ö).

-----

### 4\. üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (API-–≠–Ω–¥–ø–æ–∏–Ω—Ç)

–û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `optimize_regimen_api(input_data)`.

#### 4.1. –í—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ (`input_data`)

–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å Python (–∏–º–∏—Ç–∞—Ü–∏—è JSON-–∑–∞–ø—Ä–æ—Å–∞) —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```python
input_data = {
    "patient_data": {
        "tumor_size_cm": float,   # –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–ø—É—Ö–æ–ª–∏ (—Å–º)
        "subtype": str,           # –ú–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã–π –ø–æ–¥—Ç–∏–ø ("TNBC", "HR+HER2-", –∏ —Ç.–¥.)
        "ki67_level": float,      # –£—Ä–æ–≤–µ–Ω—å Ki-67 (%)
        "age": int,               # –í–æ–∑—Ä–∞—Å—Ç (–¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ PK)
        "patient_stage": int,     # –°—Ç–∞–¥–∏—è (1-4, –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ Loss)
        "ecog_status": int        # –°—Ç–∞—Ç—É—Å ECOG (0-4, –¥–ª—è —à—Ç—Ä–∞—Ñ–∞ –∑–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å)
    },
    "initial_regimen": {
        "dose": float,            # –ò—Å—Ö–æ–¥–Ω–∞—è (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è) –¥–æ–∑–∞ (–º–≥)
        "interval": float         # –ò—Å—Ö–æ–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–Ω–∏)
    }
}
```

#### 4.2. –í—ã—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ (–ü—Ä–∏–º–µ—Ä)

–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```json
{
  "status": "success",
  "recommended_treatment_type": "–•–∏—Ä—É—Ä–≥–∏—è + –•–∏–º–∏–æ—Ç–µ—Ä–∞–ø–∏—è",
  "optimal_regimen": {
    "dose": "285.50",          // –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∞ (–º–≥)
    "interval": "12.00",       // –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–Ω–∏)
    "cycles": 6,
    "total_time_days": "72.00"
  },
  "metrics": {
    "initial": { /* ... –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ö–µ–º—ã ... */ },
    "optimal": {
      "V_end_cm3": "1.52",      // –ö–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º
      "VR_end_cm3": "0.0001",   // –†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –ø–æ–ø—É–ª—è—Ü–∏—è
      "Tox_time_days": "0.00"   // –í—Ä–µ–º—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏
    }
  },
  "plot_data": { /* ... –º–∞—Å—Å–∏–≤—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–≤—Ä–µ–º—è, –æ–±—ä–µ–º, –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è) ... */ }
}
```

-----

### 5\. ‚ö†Ô∏è –ö–ª—é—á–µ–≤—ã–µ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –†–∏—Å–∫–∏

1.  **–®—Ç—Ä–∞—Ñ ECOG –∑–∞ –¢–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å:**
      * –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (`loss_function`) –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Å–∏–ª—å–Ω—ã–π —à—Ç—Ä–∞—Ñ –Ω–∞ –≤—Ä–µ–º—è, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è $\text{C}_1$ –ø—Ä–µ–≤—ã—à–∞–µ—Ç $\text{C}_{\text{TOX}}$.
      * –®—Ç—Ä–∞—Ñ —É—Å–∏–ª–µ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ **ECOG** ($\text{W}_{\text{Tox}} \sim \text{ECOG}^2$), —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–Ω–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —Å—Ö–µ–º—ã –¥–ª—è –æ—Å–ª–∞–±–ª–µ–Ω–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤.
2.  **–†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** –ö–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ–π –ø–æ–ø—É–ª—è—Ü–∏–∏ $\text{V}_{\text{R}}$ —Å–∏–ª—å–Ω–æ –≤–∑–≤–µ—à–µ–Ω ($\text{W}_{\text{R}}=100$) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –µ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ —Å–∏–º—É–ª–∏—Ä—É–µ—Ç –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ –æ–ø—É—Ö–æ–ª–∏.
3.  **–ù–µ–ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è `predict_treatment_type` —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ö–∏—Ä—É—Ä–≥–∏—é –∏–ª–∏ —Ç–∞—Ä–≥–µ—Ç–Ω—É—é —Ç–µ—Ä–∞–ø–∏—é, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –•–¢-—Å—Ö–µ–º—ã –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.

### 2\. ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

  * **`numpy`:** –î–ª—è —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –º–∞—Å—Å–∏–≤–æ–≤.
  * **`scipy`:** –î–ª—è —Ä–µ—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –û–î–£ (`odeint`) –∏ —á–∏—Å–ª–µ–Ω–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (`minimize`).
  * **`math`:** –î–ª—è –±–∞–∑–æ–≤—ã—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.
  * **`json`** (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –∫–æ–¥–µ, –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API).

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
pip install numpy scipy
```

-----

### 3\. üß™ –ú–æ–¥–µ–ª—å –∏ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –û—Å–Ω–æ–≤–∞

#### 3.1. PK/PD –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

–ú–æ–¥–µ–ª—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

  * **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ ($\lambda_{\text{S}}, \lambda_{\text{R}}$):** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ `_calculate_lambda_s` –Ω–∞ –æ—Å–Ω–æ–≤–µ **–º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞** (`TNBC`, `HR-HER2+`, `HR+HER2+`, `HR+HER2-`) –∏ —É—Ä–æ–≤–Ω—è **Ki-67**.
  * **–°–∫–æ—Ä–æ—Å—Ç—å —ç–ª–∏–º–∏–Ω–∞—Ü–∏–∏ ($\text{k}_{\text{e}}$):** –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç **–≤–æ–∑—Ä–∞—Å—Ç–∞** –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–≥–µ—Ä–∏–∞—Ç—Ä–∏—á–µ—Å–∫–∏–µ, –ø–µ–¥–∏–∞—Ç—Ä–∏—á–µ—Å–∫–∏–µ/–º–æ–ª–æ–¥—ã–µ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã).

#### 3.2. –°–∏—Å—Ç–µ–º–∞ –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –£—Ä–∞–≤–Ω–µ–Ω–∏–π (–û–î–£)

–í –æ—Å–Ω–æ–≤–µ –ª–µ–∂–∏—Ç —Å–∏—Å—Ç–µ–º–∞ –∏–∑ –ø—è—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏–π, –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è –¥–∏–Ω–∞–º–∏–∫—É:

$$
\frac{d\mathbf{y}}{dt} = \text{f}(\mathbf{y}, t, \text{Dose}, \text{Interval})
$$–≥–¥–µ $\mathbf{y} = [\text{V}_{\text{S}}, \text{V}_{\text{R}}, \text{C}_1, \text{C}_2, \text{Tox}_{\text{Time}}]$.

* **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ ($\text{V}_{\text{S}}$):**
$$

```
$$\\frac{dV\_S}{dt} = V\_S \\cdot (G\_S - E\_C - \\mu)
$$
$$
```

  * **–†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ ($\text{V}_{\text{R}}$):**
    $$
    $$$$\\frac{dV\_R}{dt} = V\_R \\cdot G\_R + V\_S \\cdot \\mu - V\_R \\cdot E\_C \\cdot 0.1
    $$
    $$$$($G_S, G_R$ ‚Äî –ì–æ–º–ø–µ—Ä—Ç—Ü–æ–≤—Å–∫–∏–π —Ä–æ—Å—Ç; $E_C$ ‚Äî —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞; $\mu$ ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –º—É—Ç–∞—Ü–∏–∏; $\text{C}_1, \text{C}_2$ ‚Äî –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –≤ –∫–∞–º–µ—Ä–∞—Ö).

-----

### 4\. üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (API-–≠–Ω–¥–ø–æ–∏–Ω—Ç)

–û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `optimize_regimen_api(input_data)`.

#### 4.1. –í—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ (`input_data`)

–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å Python (–∏–º–∏—Ç–∞—Ü–∏—è JSON-–∑–∞–ø—Ä–æ—Å–∞) —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```python
input_data = {
    "patient_data": {
        "tumor_size_cm": float,   # –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–ø—É—Ö–æ–ª–∏ (—Å–º)
        "subtype": str,           # –ú–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã–π –ø–æ–¥—Ç–∏–ø ("TNBC", "HR+HER2-", –∏ —Ç.–¥.)
        "ki67_level": float,      # –£—Ä–æ–≤–µ–Ω—å Ki-67 (%)
        "age": int,               # –í–æ–∑—Ä–∞—Å—Ç (–¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ PK)
        "patient_stage": int,     # –°—Ç–∞–¥–∏—è (1-4, –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ Loss)
        "ecog_status": int        # –°—Ç–∞—Ç—É—Å ECOG (0-4, –¥–ª—è —à—Ç—Ä–∞—Ñ–∞ –∑–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å)
    },
    "initial_regimen": {
        "dose": float,            # –ò—Å—Ö–æ–¥–Ω–∞—è (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è) –¥–æ–∑–∞ (–º–≥)
        "interval": float         # –ò—Å—Ö–æ–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–Ω–∏)
    }
}
```

#### 4.2. –í—ã—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ (–ü—Ä–∏–º–µ—Ä)

–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```json
{
  "status": "success",
  "recommended_treatment_type": "–•–∏—Ä—É—Ä–≥–∏—è + –•–∏–º–∏–æ—Ç–µ—Ä–∞–ø–∏—è",
  "optimal_regimen": {
    "dose": "285.50",          // –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∞ (–º–≥)
    "interval": "12.00",       // –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–Ω–∏)
    "cycles": 6,
    "total_time_days": "72.00"
  },
  "metrics": {
    "initial": { /* ... –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ö–µ–º—ã ... */ },
    "optimal": {
      "V_end_cm3": "1.52",      // –ö–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º
      "VR_end_cm3": "0.0001",   // –†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –ø–æ–ø—É–ª—è—Ü–∏—è
      "Tox_time_days": "0.00"   // –í—Ä–µ–º—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏
    }
  },
  "plot_data": { /* ... –º–∞—Å—Å–∏–≤—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–≤—Ä–µ–º—è, –æ–±—ä–µ–º, –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è) ... */ }
}
```

-----

### 5\. ‚ö†Ô∏è –ö–ª—é—á–µ–≤—ã–µ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –†–∏—Å–∫–∏

1.  **–®—Ç—Ä–∞—Ñ ECOG –∑–∞ –¢–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å:**
      * –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (`loss_function`) –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Å–∏–ª—å–Ω—ã–π —à—Ç—Ä–∞—Ñ –Ω–∞ –≤—Ä–µ–º—è, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è $\text{C}_1$ –ø—Ä–µ–≤—ã—à–∞–µ—Ç $\text{C}_{\text{TOX}}$.
      * –®—Ç—Ä–∞—Ñ —É—Å–∏–ª–µ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ **ECOG** ($\text{W}_{\text{Tox}} \sim \text{ECOG}^2$), —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–Ω–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —Å—Ö–µ–º—ã –¥–ª—è –æ—Å–ª–∞–±–ª–µ–Ω–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤.
2.  **–†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** –ö–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ–π –ø–æ–ø—É–ª—è—Ü–∏–∏ $\text{V}_{\text{R}}$ —Å–∏–ª—å–Ω–æ –≤–∑–≤–µ—à–µ–Ω ($\text{W}_{\text{R}}=100$) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –µ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ —Å–∏–º—É–ª–∏—Ä—É–µ—Ç –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ –æ–ø—É—Ö–æ–ª–∏.
3.  **–ù–µ–ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è `predict_treatment_type` —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ö–∏—Ä—É—Ä–≥–∏—é –∏–ª–∏ —Ç–∞—Ä–≥–µ—Ç–Ω—É—é —Ç–µ—Ä–∞–ø–∏—é, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –•–¢-—Å—Ö–µ–º—ã –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
### 5\. ‚ö†Ô∏è –ö–ª—é—á–µ–≤—ã–µ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –†–∏—Å–∫–∏

1.  **–®—Ç—Ä–∞—Ñ ECOG –∑–∞ –¢–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å:**
      * –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (`loss_function`) –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Å–∏–ª—å–Ω—ã–π —à—Ç—Ä–∞—Ñ –Ω–∞ –≤—Ä–µ–º—è, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è $\text{C}_1$ –ø—Ä–µ–≤—ã—à–∞–µ—Ç $\text{C}_{\text{TOX}}$.
      * –®—Ç—Ä–∞—Ñ —É—Å–∏–ª–µ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ **ECOG** ($\text{W}_{\text{Tox}} \sim \text{ECOG}^2$), —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–Ω–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —Å—Ö–µ–º—ã –¥–ª—è –æ—Å–ª–∞–±–ª–µ–Ω–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤.
2.  **–†–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** –ö–æ–Ω–µ—á–Ω—ã–π –æ–±—ä–µ–º —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ–π –ø–æ–ø—É–ª—è—Ü–∏–∏ $\text{V}_{\text{R}}$ —Å–∏–ª—å–Ω–æ –≤–∑–≤–µ—à–µ–Ω ($\text{W}_{\text{R}}=100$) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –µ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ —Å–∏–º—É–ª–∏—Ä—É–µ—Ç –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ –æ–ø—É—Ö–æ–ª–∏.
3.  **–ù–µ–ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è `predict_treatment_type` —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ö–∏—Ä—É—Ä–≥–∏—é –∏–ª–∏ —Ç–∞—Ä–≥–µ—Ç–Ω—É—é —Ç–µ—Ä–∞–ø–∏—é, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –•–¢-—Å—Ö–µ–º—ã –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
